{
  "service_map": {
    "ssl/https": "https",
    "ssl/http": "https",
    "https?": "https",
    "http-alt": "http",
    "http": "http",
    "mysql": "mysql",
    "redis": "redis",
    "mongodb": "mongodb",
    "vnc": "vnc",
    "rdp": "rdp",
    "docker": "docker",
    "kubernetes": "kubernetes",
    "elasticsearch": "elasticsearch",
    "smtp": "smtp",
    "ftp": "ftp",
    "telnet": "telnet",
    "dns": "dns",
    "ntp": "ntp",
    "snmp": "snmp",
    "ldap": "ldap",
    "couchdb": "couchdb",
    "ssh": "ssh",
    "smB": "smb"
  },

  "rules": [
    {"ports": [21], "service": "ftp", "severity": "High", "message": "FTP sends credentials in clear text; may allow anonymous login."},
    {"ports": [23], "service": "telnet", "severity": "High", "message": "Telnet transmits data unencrypted; credentials can be intercepted."},
    {"ports": [25], "service": "smtp", "severity": "Medium", "message": "SMTP can be abused as an open relay if misconfigured."},
    {"ports": [53], "service": "dns", "severity": "High", "message": "Open DNS resolvers can be abused for amplification or poisoning."},
    {"ports": [80], "service_contains": "http", "severity": "Medium", "message": "HTTP may expose outdated web apps; ensure patches and WAF."},
    {"ports": [110], "service": "pop3", "severity": "High", "message": "POP3 leaks mail credentials if not using TLS."},
    {"ports": [123], "protocol": ["udp"], "service": "ntp", "severity": "High", "message": "NTP can be used for amplification attacks; restrict access."},
    {"ports": [139, 445], "severity": "Critical", "message": "SMB exposed — high-risk (ransomware / data exfiltration)."},
    {"ports": [161], "protocol": ["udp"], "service": "snmp", "severity": "High", "message": "Default SNMP community strings expose device info."},
    {"ports": [3306], "service": "mysql", "severity": "High", "message": "Public MySQL access risks data theft or injection."},
    {"ports": [3389], "service": "rdp", "severity": "High", "message": "RDP open — brute-force and remote exploit risk."},
    {"ports": [389, 636], "service": "ldap", "severity": "High", "message": "LDAP/LDAPS may leak directory info or allow unauthorized binds."},
    {"ports": [5900], "service": "vnc", "severity": "High", "message": "VNC often has weak/no auth; consider VPN or disable."},
    {"ports": [6379], "service": "redis", "severity": "High", "message": "Unprotected Redis can be used to execute commands remotely."},
    {"ports": [27017], "service": "mongodb", "severity": "High", "message": "Open MongoDB instances historically leaked data."},
    {"ports": [5984], "service": "couchdb", "severity": "High", "message": "CouchDB may expose documents if left open."},
    {"ports": [8080, 443], "service_contains": "http", "severity": "Medium", "message": "Possible web management interface; verify if Jenkins/Tomcat or similar is exposed."},
    {"ports": [9200], "service": "elasticsearch", "severity": "Critical", "message": "Elasticsearch exposed — full DB read/write if open."},
    {"ports": [2375], "service": "docker", "severity": "Critical", "message": "Docker API exposed — remote root/container control."},
    {"ports": [6443], "service": "kubernetes", "severity": "Critical", "message": "Kubernetes API exposed — cluster compromise risk."},
    {"ports": [69], "protocol": ["udp"], "service": "tftp", "severity": "High", "message": "TFTP (UDP 69) is unauthenticated and can be used to exfiltrate or upload files."},
    {"ports": [1433], "service": "mssql", "severity": "High", "message": "MS SQL (1433) exposed — may allow database access or brute-force attacks."},
    {"ports": [1521], "service": "oracle", "severity": "High", "message": "Oracle DB (1521) exposed — risk of data access or exploitation."},
    {"ports": [5432], "service": "postgresql", "severity": "High", "message": "PostgreSQL (5432) exposed — public DB access risks data theft."},
    {"ports": [2049], "service": "nfs", "severity": "High", "message": "NFS (2049) exported shares may leak files if exposed publicly."},
    {"ports": [11211], "protocol": ["udp"], "service": "memcached", "severity": "High", "message": "Memcached (11211/UDP) can be abused for amplification DDoS and unauthenticated access."},
    {"ports": [1900], "protocol": ["udp"], "service": "ssdp", "severity": "Medium", "message": "SSDP/UPnP (1900/UDP) can leak internal device info and be abused for discovery or reflection attacks."},
    {"ports": [554], "service": "rtsp", "severity": "Medium", "message": "RTSP (554) often exposes camera streams; ensure auth and network segmentation."},
    {"ports": [10000], "service_contains": "webmin", "severity": "High", "message": "Webmin (10000) / web admin interface exposed — restrict to management network and require auth."},
    {"ports": [8888], "service_contains": "jupyter", "severity": "Medium", "message": "Jupyter / dev web consoles (8888) often run with no auth — do not expose publicly."},
    {"ports": [5672, 15672], "service_contains": "rabbitmq", "severity": "High", "message": "RabbitMQ ports exposed — management UI or broker access may be unauthenticated or privileged."},
    {"ports": [5060], "protocol": ["udp","tcp"], "service": "sip", "severity": "Medium", "message": "SIP (5060) exposed — can be abused for fraud, enumeration, or DoS."},
    {"ports": [5061], "protocol": ["tcp"], "service": "sip-tls", "severity": "Medium", "message": "SIP-TLS (5061) exposed — verify TLS and authentication."},
    {"ports": [88], "service": "kerberos", "severity": "High", "message": "Kerberos (88) exposure may leak authentication/AD-related information; restrict access."},
    {"ports": [1883], "service": "mqtt", "severity": "Medium", "message": "MQTT (1883) broker open — IoT devices/brokers can be hijacked or abused if unauthenticated."}
  ],

  "version_rules": [
  {"service": "openssh", "min_version": "7.0", "severity": "High", "message": "Outdated OpenSSH — upgrade to 7.0 or newer."},
  {"service": "apache", "min_version": "2.4.57", "severity": "Medium", "message": "Old Apache version — upgrade to 2.4.57+ for security fixes."},
  {"service": "nginx", "min_version": "1.18.0", "severity": "Medium", "message": "Older Nginx build — update to 1.18.0+."},
  {"service": "mysql", "min_version": "8.0", "severity": "High", "message": "MySQL below 8.0 may be vulnerable to privilege escalation or data leaks."},
  {"service": "postgresql", "min_version": "13.0", "severity": "Medium", "message": "PostgreSQL below 13.0 missing key security fixes."},
  {"service": "vsftpd", "min_version": "3.0.0", "severity": "Critical", "message": "vsftpd below 3.0.0 includes backdoor (CVE-2011-2523)."},
  {"service": "phpmyadmin", "min_version": "4.8.5", "severity": "High", "message": "phpMyAdmin below 4.8.5 is prone to XSS and CSRF attacks."},
  {"service": "openssl", "min_version": "1.1.1", "severity": "High", "message": "OpenSSL below 1.1.1 affected by Heartbleed and other vulnerabilities."},
  {"service": "apache tomcat", "min_version": "9.0", "severity": "High", "message": "Tomcat below 9.0 contains multiple RCE vulnerabilities."},
  {"service": "dropbear", "min_version": "2022.83", "severity": "Medium", "message": "Update Dropbear SSH to 2022.83+ to avoid known auth issues."},
  {"service": "varnish", "min_version": "6.0", "severity": "Info", "message": "Varnish cache — verify backend exposure only."}
],

  "defaults": {
    "severity": "Info",
    "message": "No specific rule matched. Review service/version manually."
  }
}