{
  "service_map": {
    "ssl/https": "https",
    "ssl/http": "https",
    "https?": "https",
    "http-alt": "http",
    "http": "http",
    "mysql": "mysql",
    "redis": "redis",
    "mongodb": "mongodb",
    "vnc": "vnc",
    "rdp": "rdp",
    "docker": "docker",
    "kubernetes": "kubernetes",
    "elasticsearch": "elasticsearch",
    "smtp": "smtp",
    "ftp": "ftp",
    "telnet": "telnet",
    "dns": "dns",
    "ntp": "ntp",
    "snmp": "snmp",
    "ldap": "ldap",
    "couchdb": "couchdb",
    "ssh": "ssh",
    "smb": "smb",
    "pop3": "pop3",
    "tftp": "tftp",
    "mssql": "mssql",
    "oracle": "oracle",
    "postgresql": "postgresql",
    "nfs": "nfs",
    "memcached": "memcached",
    "ssdp": "ssdp",
    "rtsp": "rtsp",
    "webmin": "webmin",
    "jupyter": "jupyter",
    "rabbitmq": "rabbitmq",
    "sip": "sip",
    "sip-tls": "sip-tls",
    "kerberos": "kerberos",
    "mqtt": "mqtt",
    "apache": "apache",
    "nginx": "nginx",
    "openssh": "openssh",
    "vsftpd": "vsftpd",
    "phpmyadmin": "phpmyadmin",
    "openssl": "openssl",
    "apache tomcat": "tomcat",
    "tomcat": "tomcat",
    "dropbear": "dropbear",
    "varnish": "varnish",
    "php": "php",
    "jenkins": "jenkins"
  },

  "rules": [
   {"ports": [21], "service": "ftp", "severity": "High", "message": "FTP sends credentials in clear text; disable FTP or enforce secure alternatives (SFTP/FTPS)."},
    {"ports": [23], "service": "telnet", "severity": "High", "message": "Telnet transmits data unencrypted; disable Telnet and use SSH instead."},
    {"ports": [25], "service": "smtp", "severity": "Medium", "message": "SMTP can be abused as an open relay; configure proper authentication and relay restrictions."},
    {"ports": [53], "service": "dns", "severity": "High", "message": "Open DNS resolvers can be abused; restrict queries to trusted clients only."},
    {"ports": [80], "service_contains": "http", "severity": "Medium", "message": "HTTP may expose outdated web apps; apply security patches and enable WAF."},
    {"ports": [110], "service": "pop3", "severity": "High", "message": "POP3 leaks credentials if not using TLS; enable TLS or disable service."},
    {"ports": [123], "protocol": ["udp"], "service": "ntp", "severity": "High", "message": "NTP can be used for amplification attacks; limit access to trusted sources."},
    {"ports": [139, 445], "severity": "Critical", "message": "SMB exposed — high-risk; restrict SMB access, apply patches, and enforce strong authentication."},
    {"ports": [161], "protocol": ["udp"], "service": "snmp", "severity": "High", "message": "Default SNMP strings expose info; change community strings and restrict access."},
    {"ports": [3306], "service": "mysql", "severity": "High", "message": "Public MySQL access risks data theft; restrict access and enforce strong passwords."},
    {"ports": [3389], "service": "rdp", "severity": "High", "message": "RDP open — risk of remote exploits; enable NLA, firewall, and consider VPN."},
    {"ports": [389, 636], "service": "ldap", "severity": "High", "message": "LDAP/LDAPS may leak info; enforce secure binds and restrict access."},
    {"ports": [5900], "service": "vnc", "severity": "High", "message": "VNC often has weak/no auth; require strong password or use VPN."},
    {"ports": [6379], "service": "redis", "severity": "High", "message": "Unprotected Redis can be exploited; enable authentication and firewall."},
    {"ports": [27017], "service": "mongodb", "severity": "High", "message": "Open MongoDB may leak data; bind to localhost and enable authentication."},
    {"ports": [5984], "service": "couchdb", "severity": "High", "message": "CouchDB may expose documents; restrict network access and enable auth."},
    {"ports": [8080, 443], "service_contains": "http", "severity": "Medium", "message": "Possible web management interface; restrict access, enforce authentication, and patch services like Jenkins/Tomcat."},
    {"ports": [9200], "service": "elasticsearch", "severity": "Critical", "message": "Elasticsearch exposed; restrict network access, enable authentication, and apply security patches."},
    {"ports": [2375], "service": "docker", "severity": "Critical", "message": "Docker API exposed; disable remote access or enforce TLS and authentication."},
    {"ports": [6443], "service": "kubernetes", "severity": "Critical", "message": "Kubernetes API exposed; restrict API access, enable RBAC, and use strong authentication."},
    {"ports": [69], "protocol": ["udp"], "service": "tftp", "severity": "High", "message": "TFTP (UDP 69) is unauthenticated; disable service or restrict access to trusted hosts."},
    {"ports": [1433], "service": "mssql", "severity": "High", "message": "MS SQL exposed; restrict network access, enable strong passwords, and patch regularly."},
    {"ports": [1521], "service": "oracle", "severity": "High", "message": "Oracle DB exposed; restrict access, enforce authentication, and apply security updates."},
    {"ports": [5432], "service": "postgresql", "severity": "High", "message": "PostgreSQL exposed; restrict external access and enforce strong authentication."},
    {"ports": [2049], "service": "nfs", "severity": "High", "message": "NFS exported shares may leak files; restrict client access and require authentication."},
    {"ports": [11211], "protocol": ["udp"], "service": "memcached", "severity": "High", "message": "Memcached can be abused; bind to localhost or restrict UDP access."},
    {"ports": [1900], "protocol": ["udp"], "service": "ssdp", "severity": "Medium", "message": "SSDP/UPnP may leak info; disable on untrusted networks or filter traffic."},
    {"ports": [554], "service": "rtsp", "severity": "Medium", "message": "RTSP exposes camera streams; enforce authentication and network segmentation."},
    {"ports": [10000], "service_contains": "webmin", "severity": "High", "message": "Webmin exposed; restrict to management network and enforce strong auth."},
    {"ports": [8888], "service_contains": "jupyter", "severity": "Medium", "message": "Jupyter console exposed; enable authentication and restrict network access."},
    {"ports": [5672, 15672], "service_contains": "rabbitmq", "severity": "High", "message": "RabbitMQ exposed; require authentication and restrict management UI access."},
    {"ports": [5060], "protocol": ["udp","tcp"], "service": "sip", "severity": "Medium", "message": "SIP exposed; enforce authentication and restrict network access."},
    {"ports": [5061], "protocol": ["tcp"], "service": "sip-tls", "severity": "Medium", "message": "SIP-TLS exposed; verify TLS configuration and enforce authentication."},
    {"ports": [88], "service": "kerberos", "severity": "High", "message": "Kerberos exposure; restrict access to trusted hosts and monitor for unusual activity."},
    {"ports": [1883], "service": "mqtt", "severity": "Medium", "message": "MQTT broker open; enable authentication and restrict client connections."}
  ],

 "version_rules": [
  {"service": "openssh", "min_version": "7.0", "severity": "High", "message": "OpenSSH outdated; upgrade to version 7.0 or newer immediately and enforce strong key authentication."},
  {"service": "apache", "min_version": "2.4.57", "severity": "Medium", "message": "Apache version outdated; update to 2.4.57+ and apply all security patches."},
  {"service": "nginx", "min_version": "1.18.0", "severity": "Medium", "message": "Nginx build outdated; update to 1.18.0+ and verify configuration for security best practices."},
  {"service": "mysql", "min_version": "8.0", "severity": "High", "message": "MySQL version below 8.0; upgrade to latest stable release and enforce strong passwords and access control."},
  {"service": "postgresql", "min_version": "13.0", "severity": "Medium", "message": "PostgreSQL outdated; upgrade to 13.0+ and apply security patches."},
  {"service": "vsftpd", "min_version": "3.0.0", "severity": "Critical", "message": "vsftpd version below 3.0.0 contains known backdoor; upgrade immediately to 3.0.0+ and verify configuration."},
  {"service": "phpmyadmin", "min_version": "4.8.5", "severity": "High", "message": "phpMyAdmin below 4.8.5 is vulnerable; upgrade to latest version and restrict access to trusted IPs."},
  {"service": "openssl", "min_version": "1.1.1", "severity": "High", "message": "OpenSSL outdated; upgrade to 1.1.1+ to mitigate Heartbleed and other vulnerabilities."},
  {"service": "apache tomcat", "min_version": "9.0", "severity": "High", "message": "Tomcat below 9.0 contains RCE vulnerabilities; upgrade to 9.0+ and review deployed applications."},
  {"service": "dropbear", "min_version": "2022.83", "severity": "Medium", "message": "Dropbear SSH outdated; upgrade to 2022.83+ and enforce secure authentication methods."},
  {"service": "varnish", "min_version": "6.0", "severity": "Info", "message": "Varnish cache version below 6.0; verify backend exposure and upgrade if publicly accessible."},
  {"service": "docker", "min_version": "20.10.0", "severity": "High", "message": "Docker outdated; upgrade to 20.10.0+ and enforce TLS authentication on API."},
  {"service": "kubernetes", "min_version": "1.27.0", "severity": "Critical", "message": "Kubernetes below 1.27.0 may have security issues; upgrade and enable RBAC with strong authentication."},
  {"service": "elasticsearch", "min_version": "7.17.0", "severity": "Critical", "message": "Elasticsearch outdated; upgrade to 7.17.0+ and enable authentication and network restrictions."},
  {"service": "rabbitmq", "min_version": "3.10.0", "severity": "High", "message": "RabbitMQ below 3.10.0 may be vulnerable; upgrade and enforce authentication on management UI and broker access."},
  {"service": "redis", "min_version": "6.2.0", "severity": "High", "message": "Redis below 6.2.0; upgrade and enable authentication and firewall rules."},
  {"service": "mongodb", "min_version": "6.0.0", "severity": "High", "message": "MongoDB below 6.0.0; upgrade and enable authentication and bind to localhost."},
  {"service": "couchdb", "min_version": "3.2.0", "severity": "High", "message": "CouchDB below 3.2.0; upgrade and enforce authentication and network restrictions."},
  {"service": "vsftpd", "min_version": "3.0.3", "severity": "Critical", "message": "vsftpd below 3.0.3; upgrade to fix CVE vulnerabilities."},
  {"service": "php", "min_version": "8.2.0", "severity": "High", "message": "PHP version below 8.2.0; upgrade and apply security patches."},
  {"service": "jenkins", "min_version": "2.401", "severity": "High", "message": "Jenkins below 2.401; upgrade to latest LTS and restrict admin access."},
  {"service": "tomcat", "min_version": "10.1.0", "severity": "High", "message": "Tomcat below 10.1.0; upgrade to latest version to fix RCE vulnerabilities."},
  {"service": "vsftpd", "min_version": "3.0.5", "severity": "High", "message": "vsftpd below 3.0.5; upgrade to mitigate security vulnerabilities."}
],

  "defaults": {
    "severity": "Info",
    "message": "No specific rule matched. Review service/version manually."
  }
}