{
  "server_rule": [
    {
      "pattern": "Varnish",
      "severity": "Medium",
      "message": "Varnish detected",
      "insight": "Check VCL policies, restrict purge endpoints and validate cache keys → Misconfigured Varnish could let attackers bypass caching rules or view sensitive data."
    },
    {
      "pattern": "nginx",
      "severity": "Low",
      "message": "nginx detected",
      "insight": "Remove default pages, disable unused modules and enforce strict file permissions → Weak configuration can expose server info or files."
    },
    {
      "pattern": "Apache",
      "severity": "Low",
      "message": "Apache detected",
      "insight": "Disable directory listings, remove sample sites, limit modules and apply security headers → Helps prevent attackers from discovering files or exploiting modules."
    },
    {
      "pattern": "Microsoft-IIS|IIS",
      "severity": "Medium",
      "message": "IIS detected",
      "insight": "Apply latest patches, remove default content, and restrict management endpoints → Unpatched IIS can be exploited and default content may reveal info to attackers."
    },
    {
      "pattern": "x-powered-by|X-Powered-By",
      "severity": "Low",
      "message": "X-Powered-By header found",
      "insight": "Remove version headers in server/app config → Revealing framework versions helps attackers target known vulnerabilities."
    }
  ],

  "security_header_rule": [
    {
      "pattern": "Missing: Strict-Transport-Security|missing HSTS|no Strict-Transport-Security",
      "severity": "Medium",
      "message": "HSTS missing",
      "insight": "Add Strict-Transport-Security → Without HSTS, users may connect over HTTP, allowing attackers to intercept data."
    },
    {
      "pattern": "Missing: Content-Security-Policy|missing Content-Security-Policy|no Content-Security-Policy",
      "severity": "Medium",
      "message": "CSP missing",
      "insight": "Implement Content-Security-Policy → Helps prevent cross-site scripting (XSS) attacks by restricting allowed sources."
    },
    {
      "pattern": "Missing: X-Frame-Options|missing X-Frame-Options|no X-Frame-Options",
      "severity": "Medium",
      "message": "X-Frame-Options missing",
      "insight": "Add X-Frame-Options → Prevents attackers from embedding your site in another page to perform clickjacking attacks."
    },
    {
      "pattern": "Missing: X-Content-Type-Options|missing X-Content-Type-Options",
      "severity": "Low",
      "message": "X-Content-Type-Options missing",
      "insight": "Add 'nosniff' → Prevents browsers from interpreting files as a different MIME type, reducing risk of attacks."
    },
    {
      "pattern": "Missing: Referrer-Policy|missing Referrer-Policy",
      "severity": "Low",
      "message": "Referrer-Policy missing",
      "insight": "Add a referrer policy → Helps limit the amount of information shared about user navigation between sites."
    }
  ],

  "tls_ssl_rule": [
    {
      "pattern": "self-signed|Self-Signed",
      "severity": "High",
      "message": "Self-signed certificate detected",
      "insight": "Replace with trusted CA certificate → Self-signed certificates are not trusted by browsers and can allow attackers to intercept data."
    },
    {
      "pattern": "expired certificate|Certificate expired",
      "severity": "High",
      "message": "Expired certificate detected",
      "insight": "Renew certificate → Expired certificates make your site appear untrusted and could let attackers intercept traffic."
    },
    {
      "pattern": "TLS 1.0|SSLv3|SSL 3.0|TLSv1",
      "severity": "High",
      "message": "Weak TLS/SSL protocol detected",
      "insight": "Disable old protocols and use TLS 1.2+ → Old protocols are insecure and can let attackers break encryption."
    },
    {
      "pattern": "missing HSTS|preload not present|includeSubDomains not present",
      "severity": "Medium",
      "message": "HSTS misconfigured",
      "insight": "Add Strict-Transport-Security with includeSubDomains → Proper HSTS ensures browsers only connect via HTTPS."
    }
  ],

  "cookie_rule": [
    {
      "pattern": "Cookie",
      "severity": "Medium",
      "message": "Cookie detected",
      "insight": "Set Secure and HttpOnly flags → Protects cookies from being stolen by attackers over unencrypted connections or scripts."
    },
    {
      "pattern": "session|sessid|auth|token",
      "severity": "High",
      "message": "Session cookie detected",
      "insight": "Enforce Secure, HttpOnly, SameSite and rotate IDs → Prevents attackers from hijacking user sessions."
    }
  ],

  "uncommon_header_rule": [
    {
      "pattern": "x-served-by",
      "severity": "Low",
      "message": "X-Served-By header found",
      "insight": "Remove or mask internal headers → Revealing server identifiers can help attackers plan attacks."
    },
    {
      "pattern": "x-timer",
      "severity": "Low",
      "message": "X-Timer header found",
      "insight": "Disable diagnostic headers → Exposed timing info can give attackers insight into server performance."
    },
    {
      "pattern": "x-cache-hits",
      "severity": "Low",
      "message": "X-Cache-Hits header found",
      "insight": "Restrict cache headers → Helps prevent attackers from learning caching behavior."
    },
    {
      "pattern": "server:.*\\(internal|trace|debug",
      "severity": "Low",
      "message": "Server header exposes debug info",
      "insight": "Sanitize server header → Hides internal info to reduce attack surface."
    }
  ]
}